(()=>{var e={};e.id=412,e.ids=[412],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14683:(e,t,a)=>{Promise.resolve().then(a.bind(a,38400))},17472:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,16444,23)),Promise.resolve().then(a.t.bind(a,16042,23)),Promise.resolve().then(a.t.bind(a,88170,23)),Promise.resolve().then(a.t.bind(a,49477,23)),Promise.resolve().then(a.t.bind(a,29345,23)),Promise.resolve().then(a.t.bind(a,12089,23)),Promise.resolve().then(a.t.bind(a,46577,23)),Promise.resolve().then(a.t.bind(a,31307,23))},17778:(e,t,a)=>{Promise.resolve().then(a.bind(a,43867))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31261:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return o},getImageProps:function(){return l}});let s=a(14985),r=a(44953),n=a(46533),i=s._(a(1933));function l(e){let{props:t}=(0,r.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let o=n.Image},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},34676:(e,t,a)=>{"use strict";a.d(t,{default:()=>s});let s=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/craigparker/Development/projects/escape_portal/src/components/common/Sidebar.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/craigparker/Development/projects/escape_portal/src/components/common/Sidebar.tsx","default")},34946:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(60687),r=a(43210),n=a(16189),i=a(75535),l=a(62008);function o({sessionId:e,onClose:t,onSaved:a}){let[n,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),[p,x]=(0,r.useState)(""),[h,b]=(0,r.useState)(!1),g=async()=>{if(!n||!d||!u||!p)return alert("All fields required");b(!0);try{let s=(0,i.H9)(l.db,"Sessions",e);await (0,i.mZ)(s,{results:{durationMinutes:Number(n),durationSeconds:Number(d),engagementRating:Number(u),participationRating:Number(p),submittedAt:i.Dc.now()}}),t(),a?.()}catch(e){console.error("Error saving results:",e),alert("Failed to save results.")}finally{b(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-md",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Session Results"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,s.jsx)("input",{className:"border p-2",placeholder:"Minutes",value:n,onChange:e=>o(e.target.value),type:"number"}),(0,s.jsx)("input",{className:"border p-2",placeholder:"Seconds",value:d,onChange:e=>c(e.target.value),type:"number"})]}),(0,s.jsx)("input",{className:"border p-2 w-full mb-3",placeholder:"1–5: Engagement rating",value:u,onChange:e=>m(e.target.value),type:"number",min:1,max:5}),(0,s.jsx)("input",{className:"border p-2 w-full mb-4",placeholder:"1–5: Participation rating",value:p,onChange:e=>x(e.target.value),type:"number",min:1,max:5}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{className:"px-4 py-2 bg-gray-400 rounded",onClick:()=>{o(""),c(""),m(""),x(""),t()},disabled:h,children:"Cancel"}),(0,s.jsx)("button",{className:"px-4 py-2 bg-green-600 text-white rounded",onClick:g,disabled:h,children:h?"Saving...":"Save"})]})]})})}function d(){let{id:e}=(0,n.useParams)(),[t,a]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0),[u,m]=(0,r.useState)([]),[p,x]=(0,r.useState)([]),[h,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(null),[v,j]=(0,r.useState)(""),[N,w]=(0,r.useState)(""),[y,P]=(0,r.useState)(""),[S,D]=(0,r.useState)(""),[C,k]=(0,r.useState)([{firstName:"",email:""}]),[I,_]=(0,r.useState)(null),[q,G]=(0,r.useState)([]),[M,R]=(0,r.useState)([]),[z,E]=(0,r.useState)([]),[A,T]=(0,r.useState)(""),[U,F]=(0,r.useState)(""),O=async()=>{let t=(0,i.H9)(l.db,"Organisations",String(e)),s=await (0,i.x7)(t);if(m((await (0,i.GG)((0,i.rJ)(l.db,"Games"))).docs.map(e=>({id:e.id,name:e.data().name}))),s.exists()){let e=s.data(),r=(0,i.rJ)(t,"Rounds"),n=(await (0,i.GG)(r)).docs.map(e=>{let t=e.data(),a=t.startDate instanceof i.Dc?t.startDate.toDate():new Date,s=t.endDate instanceof i.Dc?t.endDate.toDate():new Date;return{id:e.id,name:t.roundName,startDate:a.toISOString().split("T")[0],endDate:s.toISOString().split("T")[0],gameId:t.gameId||""}});a({id:s.id,organisationName:e.organisationName,rounds:n})}let r=await (0,i.GG)((0,i.rJ)(l.db,"Sessions"));x(await Promise.all(r.docs.map(async e=>{let t=e.data(),a=0;return t.teamId&&(a=(await (0,i.GG)((0,i.P)((0,i.rJ)(l.db,"TeamMembers"),(0,i._M)("teamId","==",t.teamId)))).size),{id:e.id,date:t.date,startTime:t.startTime,teamName:t.teamName||"",facilitatorName:t.facilitatorName,teamMembersCount:a,teamId:t.teamId,roundId:t.roundId||"",results:t.results||void 0}}))),c(!1)},L=(e,t,a)=>{let s=[...C];s[e][t]=a,k(s)},H=e=>{let t=C[e];t.id&&G(e=>[...e,t.id]),C.length>1&&k(C.filter((t,a)=>a!==e))},J=e=>{_(null),f(e),b(!0),j(""),w(""),P(""),D(""),k([{firstName:"",email:""}]),G([])},Q=async e=>{_(e),f(t?.rounds.find(t=>t.id===e.roundId)||null),j(e.date),w(e.startTime),P(e.facilitatorName),D(e.teamName),G([]),k((await (0,i.GG)((0,i.P)((0,i.rJ)(l.db,"TeamMembers"),(0,i._M)("teamId","==",e.teamId)))).docs.map(e=>({id:e.id,...e.data()}))),b(!0)},Y=async()=>{if(v&&N&&S&&y&&g){if(I){let t=(0,i.H9)(l.db,"Sessions",I.id),a=(0,i.H9)(l.db,"Teams",I.teamId);for(let e of(await (0,i.mZ)(t,{date:v,startTime:N,facilitatorName:y,teamName:S,roundId:g.id}),await (0,i.mZ)(a,{teamName:S,roundId:g.id}),q))await (0,i.kd)((0,i.H9)(l.db,"TeamMembers",e));let s=C.filter(e=>e.firstName&&e.email&&!e.id);await Promise.all(s.map(t=>(0,i.gS)((0,i.rJ)(l.db,"TeamMembers"),{...t,teamId:I.teamId,orgId:e,roundId:g.id,sessionDate:v,joinedAt:new Date})))}b(!1),await O()}},[Z,K]=(0,r.useState)(!1),[W,B]=(0,r.useState)(null);if(d||!t)return(0,s.jsx)("div",{children:"Loading..."});let{active:V,upcoming:X,past:$}=(e=>{let t=new Date,a=[],s=[],r=[];return e.forEach(e=>{let n=new Date(e.startDate),i=new Date(e.endDate);n<=t&&i>=t?a.push(e):n>t?s.push(e):r.push(e)}),{active:a,upcoming:s,past:r}})(t.rounds);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:t.organisationName}),(0,s.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded",onClick:()=>alert("Add round modal coming soon"),children:"➕ Add Round"})]}),[["\uD83D\uDD25 Active Round",V],["\uD83D\uDCC5 Upcoming Rounds",X],["\uD83D\uDCDC Past Rounds",$]].map(([e,t])=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mt-6",children:e}),t.map(t=>(0,s.jsxs)("div",{className:"bg-white shadow p-4 rounded mt-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-semibold",children:[t.name," (",t.startDate," – ",t.endDate,")"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Game: ",u.find(e=>e.id===t.gameId)?.name||"None assigned"]})]}),(0,s.jsxs)("div",{className:"space-x-2",children:["\uD83D\uDCDC Past Rounds"!==e&&(0,s.jsx)("button",{onClick:()=>J(t),className:"bg-blue-600 text-white px-2 py-1 rounded",children:"➕ Add Session"}),(0,s.jsx)("button",{onClick:()=>alert("Edit round"),className:"text-blue-600",children:"✏️ Edit"}),(0,s.jsx)("a",{href:`/scoreboard/${t.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:underline",children:"\uD83C\uDFC6 Leaderboard"})]})]}),(0,s.jsx)("ul",{className:"mt-3 space-y-1",children:p.filter(e=>e.roundId===t.id).map(e=>(0,s.jsxs)("li",{className:"border p-2 rounded flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:e.date})," at ",e.startTime," — ",e.teamName," (Facilitator: ",e.facilitatorName,")",(0,s.jsx)("br",{}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Members: ",e.teamMembersCount]}),e.results&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),(0,s.jsxs)("span",{className:"text-xs text-green-600",children:["\uD83D\uDD52 Duration: ",e.results.durationMinutes,"m ",e.results.durationSeconds,"s"]}),(0,s.jsx)("br",{}),(0,s.jsxs)("span",{className:"text-xs text-blue-600",children:["\uD83C\uDF1F Engagement: ",e.results.engagementRating,"/10 \xb7 Participation: ",e.results.participationRating,"/10"]}),(0,s.jsx)("br",{}),(0,s.jsxs)("span",{className:"text-xs text-purple-600 font-semibold",children:["\uD83C\uDFC5 Score: ",(()=>{let t=e.results.durationMinutes,a=Math.max(0,600-(60*t+e.results.durationSeconds)/1800*600);return parseFloat((.1*a+e.results.engagementRating/10*20+e.results.participationRating/10*20).toFixed(1))})()]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{className:"text-sm text-blue-600 hover:underline",onClick:()=>Q(e),children:"✏️ Edit"}),(0,s.jsx)("button",{className:"text-sm text-green-600 hover:underline",onClick:()=>{B(e.id),K(!0)},children:"\uD83D\uDCCA Results"})]})]},e.id))})]},t.id))]},e)),h&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold mb-4",children:[I?"Edit":"Create"," Session"]}),(0,s.jsx)("input",{className:"border p-2 w-full mb-3",type:"date",value:v,onChange:e=>j(e.target.value)}),(0,s.jsx)("input",{className:"border p-2 w-full mb-3",placeholder:"Start Time",value:N,onChange:e=>w(e.target.value)}),(0,s.jsx)("input",{className:"border p-2 w-full mb-3",placeholder:"Facilitator Name",value:y,onChange:e=>P(e.target.value)}),(0,s.jsx)("input",{className:"border p-2 w-full mb-3",placeholder:"Team Name",value:S,onChange:e=>D(e.target.value)}),(0,s.jsxs)("h3",{className:"font-semibold mb-2",children:["Team Members (",C.length,"/18)"]}),C.map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-2 mb-2 items-center",children:[(0,s.jsx)("input",{className:"border p-2",placeholder:"First Name*",value:e.firstName,onChange:e=>L(t,"firstName",e.target.value)}),(0,s.jsx)("input",{className:"border p-2",placeholder:"Last Name",value:e.lastName||"",onChange:e=>L(t,"lastName",e.target.value)}),(0,s.jsx)("input",{className:"border p-2",placeholder:"Email*",value:e.email,onChange:e=>L(t,"email",e.target.value)}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"Mobile",value:e.mobile||"",onChange:e=>L(t,"mobile",e.target.value)}),C.length>1&&(0,s.jsx)("button",{onClick:()=>H(t),className:"ml-2 text-red-500 text-sm",children:"\uD83D\uDDD1️"})]})]},t)),C.length<18&&(0,s.jsx)("button",{onClick:()=>{C.length<18&&k([...C,{firstName:"",email:""}])},className:"text-blue-600 text-sm mb-4",children:"➕ Add Member"}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{className:"px-4 py-2 bg-gray-400 rounded",onClick:()=>b(!1),children:"Cancel"}),(0,s.jsx)("button",{className:"px-4 py-2 bg-green-600 text-white rounded",onClick:Y,children:I?"Update":"Save"})]})]})}),Z&&W&&(0,s.jsx)(o,{sessionId:W,onClose:()=>{K(!1),B(null)},onSaved:O})]})}},37366:e=>{"use strict";e.exports=require("dns")},38400:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/craigparker/Development/projects/escape_portal/src/app/admin-portal/organisation/[id]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/craigparker/Development/projects/escape_portal/src/app/admin-portal/organisation/[id]/page.tsx","default")},43867:(e,t,a)=>{"use strict";a.d(t,{default:()=>u});var s=a(60687),r=a(85814),n=a.n(r),i=a(16189),l=a(31261),o=a.n(l),d=a(65553),c=a(62008);function u(){let e=(0,i.usePathname)(),t=(0,i.useRouter)(),a=async()=>{await (0,d.CI)(c.j),t.push("/")},r=(t,a=!1)=>(a?e===t:e.startsWith(t))?"block py-2 px-4 rounded bg-orange-500 text-black font-bold":"block py-2 px-4 rounded hover:bg-orange-400 hover:text-black text-white transition";return(0,s.jsxs)("aside",{className:"w-64 bg-black p-6 min-h-screen flex flex-col justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-8 self-center text-center",children:(0,s.jsx)(o(),{src:"/EPHv1.png",alt:"Escape Portal Logo",width:160,height:60,priority:!0})}),(0,s.jsxs)("nav",{className:"space-y-2",children:[(0,s.jsx)(n(),{href:"/admin-portal",className:r("/admin-portal",!0),children:"Dashboard"}),(0,s.jsx)(n(),{href:"/admin-portal/organisations",className:r("/admin-portal/organisations"),children:"Organisations"}),(0,s.jsx)(n(),{href:"/admin-portal/rounds",className:r("/admin-portal/rounds"),children:"Rounds"}),(0,s.jsx)(n(),{href:"/admin-portal/sessions",className:r("/admin-portal/sessions"),children:"Sessions"}),(0,s.jsx)(n(),{href:"/admin-portal/games",className:r("/admin-portal/games"),children:"Games"}),(0,s.jsx)(n(),{href:"/admin-portal/quizzes",className:r("/admin-portal/quizzes"),children:"Quizzes"}),(0,s.jsx)(n(),{href:"/admin-portal/phishing",className:r("/admin-portal/phishing"),children:"Phishing"}),(0,s.jsx)(n(),{href:"/admin-portal/settings",className:r("/admin-portal/settings"),children:"Settings"})]})]}),(0,s.jsx)("button",{onClick:a,className:"mt-6 w-full py-2 px-4 bg-red-600 hover:bg-red-500 text-white font-semibold rounded transition",children:"Logout"})]})}},44818:()=>{},49903:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=a(65239),r=a(48088),n=a(88170),i=a.n(n),l=a(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d={children:["",{children:["admin-portal",{children:["organisation",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,38400)),"/Users/craigparker/Development/projects/escape_portal/src/app/admin-portal/organisation/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,86512)),"/Users/craigparker/Development/projects/escape_portal/src/app/admin-portal/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94431)),"/Users/craigparker/Development/projects/escape_portal/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/craigparker/Development/projects/escape_portal/src/app/admin-portal/organisation/[id]/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/admin-portal/organisation/[id]/page",pathname:"/admin-portal/organisation/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},54730:(e,t,a)=>{Promise.resolve().then(a.bind(a,34676))},55511:e=>{"use strict";e.exports=require("crypto")},61135:()=>{},62008:(e,t,a)=>{"use strict";a.d(t,{db:()=>o,j:()=>l});var s=a(67989),r=a(65553),n=a(75535);let i=(0,s.Wp)({apiKey:"AIzaSyDD6coY49gQGo7rkhcPQY6nUhftziODTPY",authDomain:"escape-portal-au.firebaseapp.com",projectId:"escape-portal-au",storageBucket:"escape-portal-au.firebasestorage.app",messagingSenderId:"917308365081",appId:"1:917308365081:web:1fb93c63b2b43ad9678d88",measurementId:"G-LQ50CD3219"}),l=(0,r.xI)(i),o=(0,n.aU)(i)},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70440:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var s=a(31658);let r=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81024:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,86346,23)),Promise.resolve().then(a.t.bind(a,27924,23)),Promise.resolve().then(a.t.bind(a,35656,23)),Promise.resolve().then(a.t.bind(a,40099,23)),Promise.resolve().then(a.t.bind(a,38243,23)),Promise.resolve().then(a.t.bind(a,28827,23)),Promise.resolve().then(a.t.bind(a,62763,23)),Promise.resolve().then(a.t.bind(a,97173,23))},81630:e=>{"use strict";e.exports=require("http")},81770:()=>{},86512:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(37413),r=a(34676);function n({children:e}){return(0,s.jsxs)("div",{className:"flex min-h-screen bg-black text-white",children:[(0,s.jsx)(r.default,{}),(0,s.jsx)("main",{className:"flex-1 bg-white text-black p-8",children:e})]})}},91123:(e,t,a)=>{Promise.resolve().then(a.bind(a,34946))},91645:e=>{"use strict";e.exports=require("net")},94431:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n,metadata:()=>r});var s=a(37413);a(61135);let r={title:"Escape Portal",description:"Cyber escape game admin portal"};function n({children:e}){return(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{className:"bg-black text-white",children:e})})}},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[447,825,658,751,466],()=>a(49903));module.exports=s})();